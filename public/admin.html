<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>管理员后台</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="admin.css">
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&display=swap" rel="stylesheet">
</head>
<body>
    <div id="adminApp">
        <header class="app-header">
            <div class="header-left">
                <h1>🛡️ 管理员后台</h1>
                <div class="user-info">
                    <span>管理员：<span id="currentAdmin"></span></span>
                </div>
            </div>
            <div class="header-right">
                <a href="/" class="btn-secondary">返回主页</a>
                <button id="logoutBtn" class="btn-secondary">退出</button>
            </div>
        </header>

        <nav class="admin-nav">
            <button class="nav-btn active" data-tab="tasks">📋 任务管理</button>
            <button class="nav-btn" data-tab="stats">📊 数据统计</button>
            <button class="nav-btn" data-tab="users">👥 用户管理</button>
        </nav>

        <main class="admin-content">
            <!-- 任务管理 -->
            <div id="tasksTab" class="tab-content active">
                <div class="section-header">
                    <h2>任务分发</h2>
                    <button class="btn-primary" id="assignTaskBtn">+ 分配任务</button>
                </div>
                <div class="tasks-table" id="tasksTable"></div>
            </div>

            <!-- 数据统计 -->
            <div id="statsTab" class="tab-content">
                <div class="section-header">
                    <h2>数据统计</h2>
                </div>
                
                <div class="stats-section">
                    <h3>📅 每日完成任务统计</h3>
                    <div class="daily-stats" id="dailyStats"></div>
                </div>

                <div class="stats-section">
                    <h3>👤 用户任务统计</h3>
                    <div class="user-stats" id="userStats"></div>
                </div>
            </div>

            <!-- 用户管理 -->
            <div id="usersTab" class="tab-content">
                <div class="section-header">
                    <h2>用户管理</h2>
                    <button class="btn-primary" id="addUserBtn">+ 创建用户</button>
                </div>
                <div class="users-grid" id="usersGrid"></div>
            </div>
        </main>
    </div>

    <!-- 创建用户模态框 -->
    <div id="userModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>创建新用户</h3>
                <span class="close" id="closeUserModal">&times;</span>
            </div>
            <form id="userForm">
                <div class="form-group">
                    <label>用户名</label>
                    <input type="text" id="newUsername" required>
                </div>
                <div class="form-group">
                    <label>密码</label>
                    <input type="password" id="newPassword" required>
                </div>
                <div class="form-group">
                    <label>显示名称</label>
                    <input type="text" id="newHeroName" placeholder="可选">
                </div>
                <div class="form-group">
                    <label>角色</label>
                    <select id="newUserRole">
                        <option value="user">普通用户</option>
                        <option value="admin">管理员</option>
                    </select>
                </div>
                <div class="form-actions">
                    <button type="button" class="btn-secondary" id="cancelUser">取消</button>
                    <button type="submit" class="btn-primary">创建</button>
                </div>
            </form>
        </div>
    </div>

    <!-- 分配任务模态框 -->
    <div id="assignModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>分配任务</h3>
                <span class="close" id="closeAssignModal">&times;</span>
            </div>
            <form id="assignForm">
                <div class="form-group">
                    <label>选择用户</label>
                    <select id="assignUserId" required></select>
                </div>
                <div class="form-group">
                    <label>任务标题</label>
                    <input type="text" id="assignTitle" required>
                </div>
                <div class="form-group">
                    <label>任务描述</label>
                    <textarea id="assignDescription" rows="3"></textarea>
                </div>
                <div class="form-group">
                    <label>优先级</label>
                    <select id="assignPriority">
                        <option value="low">🟢 低优先级</option>
                        <option value="medium" selected>🟡 中优先级</option>
                        <option value="high">🔴 高优先级</option>
                        <option value="urgent">🚨 紧急</option>
                    </select>
                </div>
                <div class="form-actions">
                    <button type="button" class="btn-secondary" id="cancelAssign">取消</button>
                    <button type="submit" class="btn-primary">分配</button>
                </div>
            </form>
        </div>
    </div>

    <!-- 任务详情模态框 -->
    <div id="taskDetailModal" class="modal">
        <div class="modal-content task-detail-modal">
            <div class="modal-header">
                <h3>任务详情</h3>
                <span class="close" id="closeTaskDetail">&times;</span>
            </div>
            <div class="task-detail-content">
                <div class="detail-row">
                    <label>任务标题：</label>
                    <span id="detailTitle"></span>
                </div>
                <div class="detail-row">
                    <label>任务描述：</label>
                    <div id="detailDescription" class="detail-description"></div>
                </div>
                <div class="detail-row">
                    <label>分配给：</label>
                    <span id="detailUser"></span>
                </div>
                <div class="detail-row">
                    <label>分配人：</label>
                    <span id="detailAssignedBy"></span>
                </div>
                <div class="detail-row">
                    <label>优先级：</label>
                    <span id="detailPriority"></span>
                </div>
                <div class="detail-row">
                    <label>状态：</label>
                    <span id="detailStatus"></span>
                </div>
                <div class="detail-row">
                    <label>所在列：</label>
                    <span id="detailColumn"></span>
                </div>
                <div class="detail-row">
                    <label>创建时间：</label>
                    <span id="detailCreatedAt"></span>
                </div>
                <div class="detail-row">
                    <label>完成时间：</label>
                    <span id="detailCompletedAt"></span>
                </div>
            </div>
            <div class="form-actions">
                <button type="button" class="btn-secondary" onclick="adminApp.openReassignModal()">重新分配</button>
                <button type="button" class="btn-primary" id="closeTaskDetailBtn" onclick="adminApp.closeTaskDetail()">关闭</button>
            </div>
        </div>
    </div>

    <!-- 重新分配任务模态框 -->
    <div id="reassignModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>重新分配任务</h3>
                <span class="close" id="closeReassignModal">&times;</span>
            </div>
            <div class="reassign-info">
                <p>当前任务：<strong id="reassignTaskTitle"></strong></p>
                <p>当前分配给：<strong id="reassignCurrentUser"></strong></p>
            </div>
            <form id="reassignForm">
                <div class="form-group">
                    <label>重新分配给：</label>
                    <select id="reassignUserId" required></select>
                </div>
                <div class="form-actions">
                    <button type="button" class="btn-secondary" id="cancelReassign">取消</button>
                    <button type="submit" class="btn-primary">确认分配</button>
                </div>
            </form>
        </div>
    </div>

    <script src="admin.js"></script>
</body>
</html>
